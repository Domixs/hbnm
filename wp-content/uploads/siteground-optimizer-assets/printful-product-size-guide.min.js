var Printful_Product_Size_Guide;(function(){'use strict';Printful_Product_Size_Guide={modal:null,modalContentNode:null,modalBodyNode:null,sizeChartNode:null,sizeGuideData:null,translatedUnitNames:null,onSizeGuideClick:function(){if(!window.pfGlobal||!window.pfGlobal.sg_data_raw)return;this.sizeGuideData=JSON.parse(window.pfGlobal.sg_data_raw),this.translatedUnitNames={},window.pfGlobal&&window.pfGlobal.sg_unit_translations&&(this.translatedUnitNames=JSON.parse(window.pfGlobal.sg_unit_translations)),document.body.appendChild(this.createModal())},closeModal:function(){this.removeNode(this.sizeChartNode),this.removeNode(this.modalContentNode),this.removeNode(this.modalBodyNode),this.removeNode(this.modal),this.sizeChartNode=null,this.modalContentNode=null,this.modalBodyNode=null,this.modal=null},createModal:function(){return this.closeModal(),this.modal=this.buildEl('div','pf-size-guide-modal-wrapper'),this.modalBodyNode=this.buildEl('div','pf-size-guide-modal'),this.modalBodyNode.style.color=this.getTextColor(),this.modalBodyNode.style.backgroundColor=this.getBackGroundColor(),this.modalBodyNode.appendChild(this.buildModalHeader()),this.renderModalContent(Printful_Product_Size_Guide.TAB_TYPE_PERSON),this.modal.appendChild(this.modalBodyNode),this.modal},buildEl:function(c,d,a){a=a||{};var b=document.createElement(c);return d&&(b.className=d),a.id&&b.setAttribute('id',a.id),a.innerHTML&&(b.innerHTML=a.innerHTML),a.src&&b.setAttribute('src',a.src),a.onclick&&(b.onclick=a.onclick),['td','h1','h2','h3','h4','h5','h6','p'].indexOf(c)>-1&&(b.style.backgroundColor=this.getBackGroundColor(),b.style.color=this.getTextColor()),b},removeNode:function(a){a&&a.parentNode&&a.parentNode.tagName&&a.parentNode.removeChild(a)},renderModalContent:function(a){this.removeNode(this.modalContentNode),this.modalContentNode=this.buildEl('div','pf-size-guide-modal__content');var b=this.getSizeGuideDataForTab(a),c=this.getTabTitle(a);this.modalContentNode.appendChild(this.buildSizeGuideTabsNode(a)),this.modalContentNode.appendChild(this.buildTabContent(b,c)),this.modalBodyNode.appendChild(this.modalContentNode)},getSizeGuideDataForTab:function(a){return a===Printful_Product_Size_Guide.TAB_TYPE_PERSON?this.sizeGuideData.modelMeasurements:a===Printful_Product_Size_Guide.TAB_TYPE_PRODUCT?this.sizeGuideData.productMeasurements:{}},getTabTitle:function(a){return a===Printful_Product_Size_Guide.TAB_TYPE_PERSON?window.pfGlobal&&window.pfGlobal.sg_tab_title_person?window.pfGlobal.sg_tab_title_person:'Measure yourself':window.pfGlobal&&window.pfGlobal.sg_tab_title_product?window.pfGlobal.sg_tab_title_product:'Product measurements'},renderSizeChart:function(a,b){this.sizeChartNode?this.removeNode(this.sizeChartNode.firstChild):this.sizeChartNode=this.buildEl('div','pf-size-guide-modal-size-chart'),this.sizeChartNode.appendChild(this.buildSizeChartBlock(a,b))},buildModalHeader:function(){var d=window.pfGlobal&&window.pfGlobal.sg_modal_title?window.pfGlobal.sg_modal_title:'Size guide',a=this.buildEl('div','pf-size-guide-modal__header'),b,c;return a.appendChild(this.buildEl('h4','pf-size-guide-modal__title',{innerHTML:d})),b=this.buildEl('button','pf-size-guide-modal__close'),c=this.buildEl('img'),c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAgVJREFUaAXtmU2KwkAQhZ0hQbyDu7mIB3PhwoN5EXfeIYguJo9JQRMydurnNYxTDTH+dNWr71VD2mSzyZEOpAPpQDqQDqQD6UA6kA6kA80dOJ1O++Px+NVKGFrQ9Oh9WoMhPAzD5fF4XFpAQwNa0PRAf1iABXaMle7e+r4/nM/nqyVfLUZgx3nS3etutzuMddxqsfPf1cALsJKTAr0AK3omaPWSfj6f21ERx3zso5f3C1hob6da5nW8/KzuMLJVCgnpNEvDBMyGZsGibjMwC5oJ6waOhmbDhgBHQbeADQP2QreCDQW2QreEDQfWQreGpQCvhcY8bFTGk2wX8ZWMkGu5JCvPrstSmWj+vta9aX5TWGjSgJG8Ao0p80HrrAhRgSGigKbDoh468EroJrCoRf1vCUF/edA7/K+WtAJWFg19adM6XIGVWzPvcVmqweL+F1r6FhuPNbBys08zV9a89xy6pC0AlhgPdBiwp3BPrBY+BDii4Igca+DdwJGFRub6Dd4FzCiQkbOENwMzC2PmNgEzC5JusDTUwKxCBLQ8M7TU/5a6rruPReGYj/B9MDYo065MtqKl5n2qpfyu+l7dYWRceIIYDltWvtBp05ND5DQBI7CA3jKfDUMLo4C+W58N/2RyvAIahThSqEKhBU1VUE5OB9KBdCAdSAfSgXQgHUgH0oEQB74BG1sUIwNoL3cAAAAASUVORK5CYII=",b.appendChild(c),b.onclick=this.closeModal.bind(this),a.appendChild(b),a.append(this.buildEl('div','pf-size-guide-modal-clear')),a},buildSizeGuideTabsNode:function(b){var a=this.buildEl('ul','pf-product-size-guide__tabs');return a.appendChild(this.buildSizeGuideTabNode(this.getTabTitle(Printful_Product_Size_Guide.TAB_TYPE_PERSON),Printful_Product_Size_Guide.TAB_TYPE_PERSON,b)),a.appendChild(this.buildSizeGuideTabNode(this.getTabTitle(Printful_Product_Size_Guide.TAB_TYPE_PRODUCT),Printful_Product_Size_Guide.TAB_TYPE_PRODUCT,b)),a},buildSizeGuideTabNode:function(e,a,c){var d='pf-product-size-guide__tab',b;return a===c&&(d+=' pf-product-size-guide__tab--active'),b=this.buildEl('li',d,{innerHTML:e,onclick:this.renderModalContent.bind(this,a)}),a===c?b.style.backgroundColor=this.getTabBackGroundColor(!0):b.style.backgroundColor=this.getTabBackGroundColor(!1),b},buildTabContent:function(a,c){a=a||{};var b=this.buildEl('div');return b.appendChild(this.buildEl('h4',null,{innerHTML:c})),a.hasOwnProperty('description')&&b.appendChild(this.buildEl('div',null,{innerHTML:a.description})),b.appendChild(this.buildDescriptionBlock(a)),this.renderSizeChart(a),b.appendChild(this.sizeChartNode),b},buildDescriptionBlock:function(a){var b=this.buildEl('div','pf-size-guide-modal-measurements'),c;return a.hasOwnProperty('imageUrl')&&a.imageUrl&&(c=this.buildEl('div','pf-size-guide-modal-measurements__image'),c.appendChild(this.buildEl('img',null,{src:a.imageUrl})),a.hasOwnProperty('modelDescription')&&c.appendChild(this.buildEl('div',null,{innerHTML:a.modelDescription})),b.appendChild(c)),a.hasOwnProperty('imageDescription')&&b.appendChild(this.buildEl('div','pf-size-guide-modal-measurements__description',{innerHTML:a.imageDescription})),b.append(this.buildEl('div','pf-size-guide-modal-clear')),b},buildSizeChartBlock:function(a,b){var c=this.buildEl('div'),e,f,d;return!a.hasOwnProperty('sizeTableRows')||a.sizeTableRows.length<1?c:(e=a.sizeTableRows,f=this.getUniqueUnits(e),b=b||this.getDefaultUnit(f),c.appendChild(this.buildSizeChartTabsNode(a,f,b)),d=this.buildEl('div'),d.style.overflowX='auto',d.appendChild(this.buildSizeChartTable(this.getSortedChartRows(e,b))),c.appendChild(d),c)},buildSizeChartTabsNode:function(c,a,d){a=a||[];var b=this.buildEl('ul','pf-size-guide-modal-size-chart__tabs');return a.map(function(a){var e='pf-size-guide-modal-size-chart__tab';a.key===d&&(e+=' pf-size-guide-modal-size-chart__tab--active'),b.appendChild(this.buildEl('li',e,{innerHTML:a.title,onclick:this.renderSizeChart.bind(this,c,a.key)}))}.bind(this)),b},buildSizeChartTable:function(c){var a=this.buildEl('table','pf-size-guide-modal-size-chart__table'),f=this.sizeGuideData.availableSizes,d=this.buildEl('thead'),b=this.buildEl('tr'),g=window.pfGlobal&&window.pfGlobal.sg_table_header_size?window.pfGlobal.sg_table_header_size:'Size',e;return b.appendChild(this.buildEl('td',null,{innerHTML:g})),c.map(function(a){b.appendChild(this.buildEl('td',null,{innerHTML:a.title}))}.bind(this)),d.appendChild(b),a.appendChild(d),e=this.buildEl('tbody'),f.map(function(b){var a=this.buildEl('tr');a.appendChild(this.buildEl('td',null,{innerHTML:b})),c.map(function(c){a.appendChild(this.buildEl('td',null,{innerHTML:c.sizes[b]||''}))}.bind(this)),e.appendChild(a)}.bind(this)),a.appendChild(e),a},getSortedChartRows:function(a,b){return a.filter(function(a){return a.unit===b}).map(function(a){var c={},b;for(b in a.sizes){if(!a.sizes.hasOwnProperty(b))continue;c[b]=a.sizes[b].map(function(b){return a.unit===Printful_Product_Size_Guide.UNIT_INCH?this.convertToFraction(b):b.toFixed(1)}.bind(this)).join(' - ')}return{title:a.title,sizes:c}}.bind(this))},convertToFraction:function(d){var c=String(d).split('.'),a=parseInt(c[0],10),f,b,e,g;if(!c[1])return d;f=parseFloat('0.'+c[1]),b=0;for(e in Printful_Product_Size_Guide.FRACTION_MAP)if(g=Printful_Product_Size_Guide.FRACTION_MAP[e],f<g){b=e;break}return b===0&&a&&(a++,b=''),(a>0?a+' ':'')+b},getUniqueUnits:function(d){var a={},c,b;d.map(function(b){a.hasOwnProperty(b.unit)||(a[b.unit]=b.unitName)}),c=[];for(b in a)a.hasOwnProperty(b)&&c.push({key:b,title:this.getTranslatedUnitName(b,a[b])});return c},getTranslatedUnitName:function(a,b){return this.translatedUnitNames[a]?this.translatedUnitNames[a]:b},getBackGroundColor:function(){return window.pfGlobal&&window.pfGlobal.sg_modal_background_color?window.pfGlobal.sg_modal_background_color:'#FFF'},getTextColor:function(){return window.pfGlobal&&window.pfGlobal.sg_modal_text_color?window.pfGlobal.sg_modal_text_color:'#000'},getTabBackGroundColor:function(a){return a?window.pfGlobal&&window.pfGlobal.sg_active_tab_background_color?window.pfGlobal.sg_active_tab_background_color:'#FFF':window.pfGlobal&&window.pfGlobal.sg_tab_background_color?window.pfGlobal.sg_tab_background_color:'#EEE'},getDefaultUnit:function(a){var b,c;return a=a||[],b=a.map(function(a){return a.key}),c=b[0],window.pfGlobal&&window.pfGlobal.sg_primary_unit&&b.indexOf(window.pfGlobal.sg_primary_unit)>-1?window.pfGlobal.sg_primary_unit:c}},Printful_Product_Size_Guide.TAB_TYPE_PERSON='person',Printful_Product_Size_Guide.TAB_TYPE_PRODUCT='product',Printful_Product_Size_Guide.UNIT_INCH='inch',Printful_Product_Size_Guide.FRACTION_MAP={' ':.0625,'⅛':.187,'¼':.3125,'⅜':.4375,'½':.5625,'⅝':.6875,'¾':.8125,'⅞':.9375}})()